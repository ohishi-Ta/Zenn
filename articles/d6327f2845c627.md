---
title: "ã€Difyãƒ»Cloudflareãƒ»GitHubã€‘Cloudflare Quick Tunnelsã§ãƒ­ãƒ¼ã‚«ãƒ«Difyã‚’ä¸€æ™‚å…¬é–‹ã—ã¦è‡ªå‹•ã§RAGã«å–ã‚Šè¾¼ã‚“ã§ã¿ãŸ"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: 
- dify
- cloudflare
- github
 -githubactions
published: true
published_at: "2025-08-11 17:25"
---
# ã¯ã˜ã‚ã«
ä»Šå›ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ç«‹ã¡ä¸Šã’ãŸDifyã«GiHubã§ç®¡ç†ã—ã¦ã„ã‚‹è¨˜äº‹ï¼ˆ.mdãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’RAGã®ã‚½ãƒ¼ã‚¹ã¨ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’ã™ã‚‹å®Ÿè£…ã‚’è¡Œã„ã¾ã—ãŸã€‚
`localhost:80`ã§ç«‹ã¡ä¸ŠãŒã‚‹ç‚ºã€GiHubã‹ã‚‰POSTã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚
ãã“ã§ã€`Cloudflare Quick Tunnels`ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€URLã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã€GiHubã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
ãã®å®Ÿè£…æ–¹æ³•ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚

# å‰æ
- DifyãŒãƒ­ãƒ¼ã‚«ãƒ«ã§ç«‹ã¡ä¸ŠãŒã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã“ã¨
- GitHubã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã“ã¨

# Difyå´ã®è¨­å®š
GitHubã¨é€£æºã™ã‚‹ãŸã‚ã€
- APIã‚­ãƒ¼
- ãƒŠãƒ¬ãƒƒã‚¸datasetID
- API ã‚µãƒ¼ãƒãƒ¼URLï¼ˆã“ã¡ã‚‰ã¯Cloudflare Quick Tunnelsã‚’ä½¿ç”¨ã—ã¾ã™ï¼‰

## æ ¼ç´ã™ã‚‹ãŸã‚ã®ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ
ä¸€æ—¦ã€ç©ºã®ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚
![](https://storage.googleapis.com/zenn-user-upload/6ae44cf7ad86-20250811.png)
![](https://storage.googleapis.com/zenn-user-upload/21ffea4a515a-20250811.png)

### ãƒŠãƒ¬ãƒƒã‚¸ã®APIã‚­ãƒ¼ã®å–å¾—
ä»¥ä¸‹ã®ç®‡æ‰€ã‹ã‚‰ã€APIã‚­ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚
:::message
**ã‚¹ã‚¿ã‚¸ã‚ª**ã®APIã‚­ãƒ¼ã‚‚å­˜åœ¨ã—ã¾ã™ãŒã€ä»Šå›ä½¿ã†ã®ã¯**ãƒŠãƒ¬ãƒƒã‚¸**ã®APIã‚­ãƒ¼ã§ã™ã€‚
:::
![](https://storage.googleapis.com/zenn-user-upload/9ef6ddfa1c9f-20250811.png)
![](https://storage.googleapis.com/zenn-user-upload/11176d08f544-20250811.png)

### datasetIDã®å–å¾—
ã“ã¡ã‚‰ã¯ã€å…ˆã»ã©ä½œæˆã—ãŸãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã®URLã«è¨˜è¼‰ãŒã‚ã‚Šã¾ã™ã€‚
```
http://localhost/datasets/{ã“ã“ãŒdatasetIDã§ã™}/documents
```

ã“ã‚Œã§Difyå´ã®è¨­å®šã¯å®Œäº†ã§ã™ã€‚

# Cloudflare Quick Tunnelsã®è¨­å®š
### Cloudflare Quick Tunnelsã¨ã¯
Cloudflare Quick Tunnels ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‘ã‚½ã‚³ãƒ³ã‚„ã‚µãƒ¼ãƒãƒ¼ã§å‹•ã„ã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ä¸€æ™‚çš„ã«å…¬é–‹ã§ãã‚‹ä»•çµ„ã¿ã§ã™ã€‚
å°‚ç”¨ãƒ„ãƒ¼ãƒ« cloudflared ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Cloudflare ãŒå®‰å…¨ãªé€šã‚Šé“ï¼ˆãƒˆãƒ³ãƒãƒ«ï¼‰ã‚’ä½œã‚Šã€ãƒ©ãƒ³ãƒ€ãƒ ãªURLã‚’ç™ºè¡Œã—ã¦ãã‚Œã¾ã™ã€‚
ã“ã®æ–¹æ³•ãªã‚‰ãƒãƒ¼ãƒˆé–‹æ”¾ã‚„DNSã®è¨­å®šã¯ä¸è¦ã§ã€ã™ãã«å¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è¨­å®šã‚‚å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚

https://qiita.com/dekoboko/items/5c209f4a524242d8a996
https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/
https://zenn.dev/takajun/articles/fbd783e459c722

### Cloudflaredã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
Cloudflaredã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/downloads/#linux
```
# macOS
brew install cloudflared

# Windows
winget install --id Cloudflare.cloudflared
```

### ãƒˆãƒ³ãƒãƒ«ã‚’é–‹å§‹
```
cloudflared tunnel --url http://localhost:80

# å‡ºåŠ›ä¾‹ï¼š
# 2024-01-01 12:00:00 INF +------------------------------------------------------------+
# 2024-01-01 12:00:00 INF |  Your quick tunnel has been created! Visit it at:        |
# 2024-01-01 12:00:00 INF |  https://random-words-here.trycloudflare.com             |
# 2024-01-01 12:00:00 INF +------------------------------------------------------------+
```

ã“ã®å‡ºåŠ›ã•ã‚ŒãŸURLã‚’ä½¿ç”¨ã—ã¾ã™ã€‚


# GitHubã®è¨­å®š
### ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
è©²å½“ãƒªãƒã‚¸ãƒˆãƒªã®`setting`ã®`Secrets and variables`ã®`Actions`ã‚’é–‹ãã¾ã™ã€‚
`Repository secrets`ã«ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ã€å…ˆã»ã©å…¥æ‰‹ã—ãŸ ä¸‹è¨˜ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
- APIã‚­ãƒ¼
- ãƒŠãƒ¬ãƒƒã‚¸datasetID
- API ã‚µãƒ¼ãƒãƒ¼URLï¼ˆCloudflare Quick Tunnelsã§å–å¾—ã—ãŸURLï¼‰

![](https://storage.googleapis.com/zenn-user-upload/2622b6ef5c6c-20250811.png)

### ã‚³ãƒ¼ãƒ‰ã«è¨­å®š
`Actions`ã‚¿ãƒ–ã«ç§»å‹•ã—ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/26da7b82b31e-20250811.png)

`New workflow`ã‚’æŠ¼ä¸‹ã—ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/406367d55b6b-20250811.png)

`set up a workflow yourself `ã‚’æŠ¼ä¸‹ã—ã¦ã€ç‹¬è‡ªã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/f0f208bbf115-20250811.png)

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€æ¥ç¶šãƒ†ã‚¹ãƒˆã®ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚
```yml:yml
name: Test Dify Connection

on:
  workflow_dispatch:

jobs:
  test-connection:
    runs-on: ubuntu-latest
    
    steps:
    - name: Test Dify API Connection
      env:
        DIFY_API_KEY: ${{ secrets.DIFY_API_KEY }}
        DIFY_API_URL: ${{ secrets.DIFY_API_URL }}
        DIFY_DATASET_ID: ${{ secrets.DIFY_DATASET_ID }}
      run: |
        echo "ğŸ” Testing Dify API connection..."
        
        # APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
        response=$(curl -s -o /dev/null -w "%{http_code}" \
          -H "Authorization: Bearer $DIFY_API_KEY" \
          "$DIFY_API_URL/datasets/$DIFY_DATASET_ID")
        
        if [ $response -eq 200 ]; then
          echo "âœ… Successfully connected to Dify API!"
          
          # Datasetæƒ…å ±ã‚’å–å¾—
          curl -s -H "Authorization: Bearer $DIFY_API_KEY" \
            "$DIFY_API_URL/datasets/$DIFY_DATASET_ID" | \
            python3 -m json.tool
        else
          echo "âŒ Failed to connect. HTTP Status: $response"
          exit 1
        fi
```


### å®Ÿè¡Œ
APIãŒé€šã‚‹ã‹GitHubä¸Šã§ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
`Run workflow`ã‚’æŠ¼ä¸‹ã—ã¾ã™ã€‚
ç·‘ã®ãƒãƒ¼ã‚¯ãŒã¤ã‘ã°æˆåŠŸã§ã™ï¼
          
![](https://storage.googleapis.com/zenn-user-upload/ae892c95f715-20250811.png)
![](https://storage.googleapis.com/zenn-user-upload/8d22338ebbbf-20250811.png)

# ãŠã‚ã‚Šã«
ä»Šå›ã¯ã€Cloudflare Quick Tunnels ã‚’ä½¿ã£ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ã—ã¦ã„ã‚‹ Dify ã‚’å¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ã—ã€GitHub ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§å–ã‚Šè¾¼ã‚€æµã‚Œã‚’ã”ç´¹ä»‹ã—ã¾ã—ãŸã€‚
Quick Tunnels ã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸è¦ãƒ»è¨­å®šæœ€å°é™ã§ä½¿ãˆã‚‹ãŸã‚ã€é–‹ç™ºä¸­ã®æ¤œè¨¼ã‚„çŸ­æœŸçš„ãªå¤–éƒ¨æ¥ç¶šã«ã¯ã¨ã¦ã‚‚ä¾¿åˆ©ã§ã™ã€‚
ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã®åŠ¹ç‡åŒ–ã‚„ãƒ‡ãƒ¢ç’°å¢ƒæ§‹ç¯‰ã®ä¸€æ‰‹æ®µã¨ã—ã¦ã€ãœã²æ´»ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚